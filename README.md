# Barsotion BarsikOS v2.20α (27.04.2024)

A simple multitask operation system for 'Laulaja-4' computer based on 8085

What is new?
- Ликвидирована ужасающая Подстава, которая не давала создавать произвольные адресные пространства. Функция SYS_Usr_muutos перенесена из сектора 0 в сектор F ОЗУ, чтобы мочь переходить к выполнению процессов, расположеных НЕ в секторе 0. Также изменен алгоритм работы Диспетчера Задач: теперь если дескриптор ожидаемого процесса не будет обнаружен в очереди QSAP, ждущий процесс будет запущен, а не отклонен.

TODO:
- Разобраться в том, как работает файловая система FAT. Написать некое подобие файловой системы FAT для своего компьютера.
- Подумать над тем, как можно улучшить распределение времени в системе. В хорошем диспетчере задач величины квантов времени должны вычисляться исходя из совокупности приоритетов текущих задач. Должны быть фиксированы доли машинного времени для процессов разных приоритетов, а не величины квантов времени. В текущих условиях диспетчер задач работает, но не так эффективно, как мог бы

Version history:
- BarsikOS v2.19 (23.01.2024) - Добавлена функция поиска первого кластера файла по строке-пути (FAT_FBP). Переработана функция FAT_FNC, исправлены ошибки. Написана, но не протестирована функция инициализации программируемого контроллера прерываний типа КР1810ВН59А (8259A).
- BarsikOS v2.18 (24.12.2023) - Добавлена поддержка графического дисплея ST7920. Добавлена переработанная графическая библиотека GRLIB_Barsotion
- BarsikOS v2.17 (23.12.2023) - Переработан и протестирован Убийца процессов. Теперь осуществляется проверка на ожидаемость и удаление дескриптора САП из очереди QSAP при необходимости.
- BarsikOS-2.16 (13.12.2023) - Переписан диспетчер задач, изменена форма дескрипторов процессов. Теперь дескрипторы процессов (САП) имеют длину 32 байта, а не 29. Диспетчер задач проверяет статус процесса (4 варианта: Запущен, Ожидает критического ресурса, Ожидает выполнения другого процесса, Завершен).
- BarsikOS-2.15 (11.12.2023) - Дополнен диспетчер задач. Теперь области стека разных процессов разделены. Добавлен файл с обработчиками ошибок errorh.asm. Он должен содержать обработчики фатальных ошибок, ошибок диска и, возможно, других.
- BarsikOS-2.14 (10.12.2023) - Написаны функции FAT_FIND_NEXT_CLUSTER и FAT_FIND_BY_NAME (детали будующей файловой системы). Протестены, работают, но необходимо провести более полный тест во всех условиях.
- BarsikOS-2.13 (06.12.2023) - Модифицирована и испытана функция чтения 4кБ-сектора твердотельного накопителя (SPIFlash W25Q64) W25_SECTOR_READ.  Драйвер микросхем SPIFlash 25-й серии работает.
- BarsikOS-2.12 (04.12.2023) - Добавлена драйвер твердотельного накопителя (SPIFlash W25Q64). Испытаны функции чтения ID, записи и стирания 4кБ-секторов
- BarsikOS-2.11 (26.11.2023) - Испытан системный таймер. Добавлена функция SYS_Read_Time_Ms - чтение машинного времени в миллисекундах; доработан алгоритм возврата из системной функции (добавлен контроль за временем выполнения системной функции)
- BarsikOS-2.10 (24.11.2023) - Диспетчер задач улучшен, добавлена приоретизация процессов (Planner was advanced, a prioretization added)
